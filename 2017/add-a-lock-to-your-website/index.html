<!-- build time:Wed Mar 22 2017 14:30:52 GMT+0800 (中国标准时间) --><!doctype html><html class="theme-next pisces use-motion" lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="//fonts.proxy.ustclug.org/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css"><meta name="keywords" content="Let's Encrypt,https,cerbot,"><link rel="alternate" href="/atom.xml" title="云淡风轻" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/images/avatar.jpg?v=5.1.0"><meta name="description" content="今天抽时间将所有的网站SSL证书都更新了成 Let’s Encrypt 了。采用了certbot 这样的自动化工具，配置管理起来非常容易(一本正经的胡说八道)，这里将对整个体验过程做个详细记录。"><meta property="og:type" content="article"><meta property="og:title" content="给你的网站加把锁 -- Let's Encrypt 完全体验"><meta property="og:url" content="http://ioliu.cn/2017/add-a-lock-to-your-website/index.html"><meta property="og:site_name" content="云淡风轻"><meta property="og:description" content="今天抽时间将所有的网站SSL证书都更新了成 Let’s Encrypt 了。采用了certbot 这样的自动化工具，配置管理起来非常容易(一本正经的胡说八道)，这里将对整个体验过程做个详细记录。"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006qRazegy1fdunpet5toj30t50d7n3d.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006qRazegy1fduo29ztewj30mb0bxt9d.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006qRazegy1fdup0jojf7j30fv0bdwf1.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006qRazegy1fdupi6lhxmj30oz0lon0q.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006qRazegy1fdupmoluqij306y035glg.jpg"><meta property="og:image" content="https://ws1.sinaimg.cn/large/006qRazegy1fdupydm71rj30ts0fkt9s.jpg"><meta property="og:updated_time" content="2017-03-22T02:03:36.645Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="给你的网站加把锁 -- Let's Encrypt 完全体验"><meta name="twitter:description" content="今天抽时间将所有的网站SSL证书都更新了成 Let’s Encrypt 了。采用了certbot 这样的自动化工具，配置管理起来非常容易(一本正经的胡说八道)，这里将对整个体验过程做个详细记录。"><meta name="twitter:image" content="https://ws1.sinaimg.cn/large/006qRazegy1fdunpet5toj30t50d7n3d.jpg"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Pisces",sidebar:{position:"right",display:"post",offset:12,offset_float:0,b2t:!0,scrollpercent:!0},fancybox:!0,motion:!0,duoshuo:{userId:"0",author:"云淡风轻"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://ioliu.cn/2017/add-a-lock-to-your-website/"><title>给你的网站加把锁 -- Let's Encrypt 完全体验 | 云淡风轻</title></head><body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans"><script>!function(e,t,a,n,c,o,s){e.GoogleAnalyticsObject=c,e[c]=e[c]||function(){(e[c].q=e[c].q||[]).push(arguments)},e[c].l=1*new Date,o=t.createElement(a),s=t.getElementsByTagName(a)[0],o.async=1,o.src=n,s.parentNode.insertBefore(o,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-61934506-1","auto"),ga("send","pageview")</script><script type="text/javascript">var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?2119376191e432c012a0713bcca8a8ea";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><div class="container sidebar-position-right page-post-detail"><div class="headband"></div><header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">云淡风轻</span> <span class="logo-line-after"><i></i></span></a></div><h1 class="site-subtitle" itemprop="description">一个安静的角落</h1></div><div class="site-nav-toggle"><button><span class="btn-bar"></span> <span class="btn-bar"></span> <span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class="menu-item menu-item-tags"><a href="/tags" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br>标签</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i><br>站点地图</a></li></ul></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope itemtype="http://schema.org/Article"><link itemprop="mainEntityOfPage" href="http://ioliu.cn/2017/add-a-lock-to-your-website/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="name" content="云淡风轻"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.jpg"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="云淡风轻"></span><header class="post-header"><h2 class="post-title" itemprop="name headline">给你的网站加把锁 -- Let's Encrypt 完全体验</h2><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-21T18:30:25+08:00">2017-03-21 </time></span><span class="post-category"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/学习笔记/" itemprop="url" rel="index"><span itemprop="name">学习笔记</span> </a></span></span><span class="post-comments-count"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><a href="/2017/add-a-lock-to-your-website/#comments" itemprop="discussionUrl"><span class="post-comments-count ds-thread-count" data-thread-key="2017/add-a-lock-to-your-website/" itemprop="commentCount"></span> </a></span><span id="/2017/add-a-lock-to-your-website/" class="leancloud_visitors" data-flag-title="给你的网站加把锁 -- Let's Encrypt 完全体验"><span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数 </span><span class="leancloud-visitors-count"></span></span></div></header><div class="post-body" itemprop="articleBody"><p><img src="https://ws1.sinaimg.cn/large/006qRazegy1fdunpet5toj30t50d7n3d.jpg" alt=""></p><p>今天抽时间将所有的网站<a href="https://zh.wikipedia.org/wiki/%E5%82%B3%E8%BC%B8%E5%B1%A4%E5%AE%89%E5%85%A8%E5%8D%94%E8%AD%B0" target="_blank" rel="external">SSL证书</a>都更新了成 <a href="https://letsencrypt.org/" target="_blank" rel="external">Let’s Encrypt</a> 了。采用了<a href="https://certbot.eff.org" target="_blank" rel="external">certbot</a> 这样的自动化工具，配置管理起来非常容易(一本正经的胡说八道)，这里将对整个体验过程做个详细记录。</p><a id="more"></a><h1 id="了解-Let’s-Encrypt"><a href="#了解-Let’s-Encrypt" class="headerlink" title="了解 Let’s Encrypt"></a>了解 Let’s Encrypt</h1><blockquote><p>The project aims to make encrypted connections in the World Wide Web the default case. By getting rid of payment, web server configuration, validation emails and dealing with expired certificates it is meant to significantly lower the complexity of setting up and maintaining TLS encryption.On a Linux web server, execution of only two commands is sufficient to set up HTTPS encryption, acquire and install certificates within 20 to 30 seconds.</p></blockquote><p><a href="https://letsencrypt.org/" target="_blank" rel="external">Let’s Encrypt</a> 是一个2015年末推出的数字证书认证机构，将通过旨在消除当前手动创建和安装证书的复杂过程的自动化流程，为安全网站提供免费的SSL/TLS证书。</p><h1 id="获取-Let’s-Encrypt"><a href="#获取-Let’s-Encrypt" class="headerlink" title="获取 Let’s Encrypt"></a>获取 Let’s Encrypt</h1><p><img src="https://ws1.sinaimg.cn/large/006qRazegy1fduo29ztewj30mb0bxt9d.jpg" alt=""><br>Let’s Encrypt 证书生成不需要手动进行，官方推荐 <a href="https://certbot.eff.org" target="_blank" rel="external">Certbot</a> 这套自动化工具来实现。3步轻松搞定：</p><ul><li>下载安装 certbot (Let’s Encrypt项目的自动化工具)</li><li>获得SSL证书</li><li>修改Nginx配置文件</li><li>续订</li></ul><h2 id="1-安装-Certbot"><a href="#1-安装-Certbot" class="headerlink" title="1. 安装 Certbot"></a>1. 安装 Certbot</h2><p>根据 <a href="https://certbot.eff.org" target="_blank" rel="external">Certbot</a> 官网指南，Debian 8上执行如下命令，安装certbot:<br></p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ sudo apt-get update</div><div class="line">$ sudo apt-get install certbot -t jessie-backports</div></pre></td></tr></table></figure><p></p><p>等安装完成，<code>certbot</code>就可以使用了。</p><h2 id="2-获取SSL证书"><a href="#2-获取SSL证书" class="headerlink" title="2. 获取SSL证书"></a>2. 获取SSL证书</h2><p>Let’s Encrypt提供了通过各种插件获取SSL证书的各种方法。不同的是Apache的插件，大多数的插件只会帮助你得到，你必须手动配置你的Web服务器使用证书。仅获取证书而不安装证书的插件称为“验证器”，因为它们用于验证服务器是否应颁发证书。<br>下面将使用<code>Webroot</code>的插件来获取SSL证书。</p><h3 id="如何使用-Webroot-插件："><a href="#如何使用-Webroot-插件：" class="headerlink" title="如何使用 Webroot 插件："></a>如何使用 Webroot 插件：</h3><p>Webroot 的工作插件放置在一个特殊的文件<code>/.well-known</code>目录文档根目录下，它可以打开（通过Web服务器）内由让我们的加密服务进行验证。 根据配置的不同，你可能需要明确允许访问/.well-known目录。</p><p>为了确保该目录可供Let’s Encrypt进行验证，让我们快速更改我们的Nginx配置。编辑<code>/etc/nginx/conf.d/example.com.conf</code>文件，并将下面代码添加进去:<br></p><figure class="highlight nginx"><table><tr><td class="code"><pre><div class="line"><span class="attribute">location</span> <span class="regexp">~ /.well-known</span> &#123;</div><div class="line">    <span class="attribute">allow</span> all;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p>使用<code>nginx -t</code>测试配置文件是否正确，在正确的情况下，重新让Nginx重新加载配置文件:<br></p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ sudo systemctl reload nginx</div></pre></td></tr></table></figure><p></p><h3 id="使用certbot命令获取证书："><a href="#使用certbot命令获取证书：" class="headerlink" title="使用certbot命令获取证书："></a>使用certbot命令获取证书：</h3><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ sudo certbot certonly --webroot -w /var/www/example <span class="_">-d</span> example.com <span class="_">-d</span> www.example.com -w /var/www/thing <span class="_">-d</span> thing.is <span class="_">-d</span> m.thing.is</div></pre></td></tr></table></figure><ul><li><code>-w</code>:指定网站所在目录</li><li><code>-d</code>:指定要生成证书的域名，如果你想多个域名保存在一个证书里(最多四个)(如<code>example.com</code>、<code>www.example.com</code>、<code>thing.is</code>、<code>m.thing.is</code>)，请确保使用适当的webroot路径和域名替换命令中的相对应部分。</li></ul><p>接下来，同意加密订阅协议：<br><img src="https://ws1.sinaimg.cn/large/006qRazegy1fdup0jojf7j30fv0bdwf1.jpg" alt=""></p><p>如果一切顺利，你应该看到一个类似下面的输出消息：</p><blockquote><p><strong>IMPORTANT NOTES:</strong></p><ul><li>Congratulations! Your certificate and chain have been saved at<br><code>/etc/letsencrypt/live/example.com/fullchain.pem</code>. Your cert will expire<br>on <strong><code>2017-06-19</code></strong>. To obtain a new or tweaked version of this<br>certificate in the future, simply run certbot again. To<br>non-interactively renew <em>all</em> of your certificates, run “certbot<br>renew”</li><li><p>If you like Certbot, please consider supporting our work by:</p><p>Donating to ISRG / Let’s Encrypt: <a href="https://letsencrypt.org/donate" target="_blank" rel="external">https://letsencrypt.org/donate</a><br>Donating to EFF: <a href="https://eff.org/donate-le" target="_blank" rel="external">https://eff.org/donate-le</a></p></li></ul></blockquote><h3 id="证书文件"><a href="#证书文件" class="headerlink" title="证书文件"></a>证书文件</h3><p>如果运行顺利，所有服务器所需要的证书就已经生成好了。他们被放在了 <code>/etc/letsencrypt/live/example.com/</code> 下：<br></p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ ls /etc/letsencrypt/live/example.com/</div><div class="line">cert.pem <span class="comment">#server cert only  </span></div><div class="line">privkey.pem <span class="comment">#private key  </span></div><div class="line">chain.pem <span class="comment">#intermediates  </span></div><div class="line">fullchain.pem <span class="comment">#server cert + intermediates</span></div></pre></td></tr></table></figure><p></p><h2 id="3-修改Nginx配置文件"><a href="#3-修改Nginx配置文件" class="headerlink" title="3.修改Nginx配置文件"></a>3.修改Nginx配置文件</h2><p>到这里已经成功一大半了，只需要配置 Nginx 支持刚刚生成的证书。最佳实践可以参考<a href="https://mozilla.github.io/server-side-tls/ssl-config-generator/" target="_blank" rel="external">Mozilla SSL Configuration Generator</a>。<br><img src="https://ws1.sinaimg.cn/large/006qRazegy1fdupi6lhxmj30oz0lon0q.jpg" alt=""><br>注意去掉HSTS的勾(勾上会强制https，并且很难消除后续影响)。</p><p>请根据自己的服务配置修改和添加内容，<strong>重点只需要关注6行</strong>：<br></p><figure class="highlight"><table><tr><td class="code"><pre><div class="line">server &#123;  </div><div class="line">    listen 443 ssl http2;</div><div class="line">    ....</div><div class="line">    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;</div><div class="line">    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;</div><div class="line">    ssl_dhparam /etc/nginx/ssl/dhparam.pem;</div><div class="line"></div><div class="line">    ssl_trusted_certificate /etc/letsencrypt/live/example.com/root_ca_cert_plus_intermediates;</div><div class="line"></div><div class="line">    resolver &lt;IP DNS resolver&gt;;</div><div class="line">    ....</div><div class="line">&#125;</div></pre></td></tr></table></figure><p></p><p><code>dhparam.pem</code>可以通过以下命令生成：<br></p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ sudo mkdir /etc/nginx/ssl</div><div class="line">$ sudo openssl dhparam -out /etc/nginx/ssl/dhparam.pem 2048</div></pre></td></tr></table></figure><p></p><p>Nginx 配置完成后重启，用浏览器测试是否一切正常。<br><img src="https://ws1.sinaimg.cn/large/006qRazegy1fdupmoluqij306y035glg.jpg" alt=""></p><h2 id="4-续订"><a href="#4-续订" class="headerlink" title="4.续订"></a>4.续订</h2><p><code>Let&#39;s Encrypt</code>证书有效期只有3个月，所以，需要定时renew。我将使用<code>corntab</code>来执行renew命令:<br></p><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ sudo crontab <span class="_">-e</span></div></pre></td></tr></table></figure><p></p><p>添加以下行：<br></p><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">30 2 * * 1 /usr/bin/certbot renew &gt;&gt; /var/log/le-renew.log &amp;&amp; /bin/systemctl reload nginx</div></pre></td></tr></table></figure><p></p><p>保存，并退出。这个定时任务将在每个星期一的凌晨两点半执行<code>certbot renew</code>命令，并重启Nginx。最后将日志输出到<code>/var/log/le-renewal.log</code>。</p><h1 id="测试你的网站-SSL-安全性"><a href="#测试你的网站-SSL-安全性" class="headerlink" title="测试你的网站 SSL 安全性"></a>测试你的网站 SSL 安全性</h1><p><a href="https://www.ssllabs.com/ssltest/index.html" target="_blank" rel="external">Qualys SSL Labs</a> 提供了全面的 SSL 安全性测试，填写你的网站域名，给自己的 HTTPS 配置打个分。<br><img src="https://ws1.sinaimg.cn/large/006qRazegy1fdupydm71rj30ts0fkt9s.jpg" alt=""><br>这意味着你网站的HTTPS已经启用成功啦，为自己鼓个掌。 (๑•̀ㅂ•́)و✧。</p></div><div></div><div><div style="padding:10px 0;margin:20px auto;width:90%;text-align:center"><div>您的支持将鼓励我继续创作！</div><button id="rewardButton" disable="enable" onclick='var e=document.getElementById("QR");"none"===e.style.display?e.style.display="block":e.style.display="none"'><span>赏</span></button><div id="QR" style="display:none"><div id="wechat" style="display:inline-block"><img id="wechat_qr" src="/images/wechatpay.png" alt="云淡风轻 WeChat Pay"><p>微信打赏</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="/images/alipay.png" alt="云淡风轻 Alipay"><p>支付宝打赏</p></div></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong> 云淡风轻</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://ioliu.cn/2017/add-a-lock-to-your-website/" title="给你的网站加把锁 -- Let's Encrypt 完全体验">http://ioliu.cn/2017/add-a-lock-to-your-website/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Let-s-Encrypt/" rel="tag"># Let's Encrypt</a> <a href="/tags/https/" rel="tag"># https</a> <a href="/tags/cerbot/" rel="tag"># cerbot</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/2016/hello-november/" rel="next" title="你好，十一月"><i class="fa fa-chevron-left"></i> 你好，十一月</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"></div></div></footer></article><div class="post-spread"></div></div></div><div class="comments" id="comments"><div class="ds-thread" data-thread-key="2017/add-a-lock-to-your-website/" data-title="给你的网站加把锁 -- Let's Encrypt 完全体验" data-url="http://ioliu.cn/2017/add-a-lock-to-your-website/"></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span> <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span> <span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">文章目录</li><li class="sidebar-nav-overview" data-target="site-overview">站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="云淡风轻"><p class="site-author-name" itemprop="name">云淡风轻</p><p class="site-description motion-element" itemprop="description"></p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href="/archives"><span class="site-state-item-count">18</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/index.html"><span class="site-state-item-count">3</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/index.html"><span class="site-state-item-count">39</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/xCss" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub </a></span><span class="links-of-author-item"><a href="http://weibo.com/BingPictures" target="_blank" title="Weibo"><i class="fa fa-fw fa-weibo"></i> Weibo</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-globe"></i> Friends</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://www.gehaowu.com" title="GeHaoWu" target="_blank">GeHaoWu</a></li><li class="links-of-blogroll-item"><a href="https://qistchan.com" title="QistChan" target="_blank">QistChan</a></li><li class="links-of-blogroll-item"><a href="https://napolin.cn" title="nApolin" target="_blank">nApolin</a></li><li class="links-of-blogroll-item"><a href="https://www.haomwei.com" title="屠城" target="_blank">屠城</a></li><li class="links-of-blogroll-item"><a href="https://ansheng.me/" title="安生's Blog" target="_blank">安生's Blog</a></li><li class="links-of-blogroll-item"><a href="http://www.fedog.me/" title="前端狗" target="_blank">前端狗</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#了解-Let’s-Encrypt"><span class="nav-number">1.</span> <span class="nav-text">了解 Let’s Encrypt</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#获取-Let’s-Encrypt"><span class="nav-number">2.</span> <span class="nav-text">获取 Let’s Encrypt</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-安装-Certbot"><span class="nav-number">2.1.</span> <span class="nav-text">1. 安装 Certbot</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-获取SSL证书"><span class="nav-number">2.2.</span> <span class="nav-text">2. 获取SSL证书</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#如何使用-Webroot-插件："><span class="nav-number">2.2.1.</span> <span class="nav-text">如何使用 Webroot 插件：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用certbot命令获取证书："><span class="nav-number">2.2.2.</span> <span class="nav-text">使用certbot命令获取证书：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#证书文件"><span class="nav-number">2.2.3.</span> <span class="nav-text">证书文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-修改Nginx配置文件"><span class="nav-number">2.3.</span> <span class="nav-text">3.修改Nginx配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-续订"><span class="nav-number">2.4.</span> <span class="nav-text">4.续订</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#测试你的网站-SSL-安全性"><span class="nav-number">3.</span> <span class="nav-text">测试你的网站 SSL 安全性</span></a></li></ol></div></div></section><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><div class="copyright"><a class="theme-link" target="_blank" href="http://www.miitbeian.gov.cn/">粤ICP备15050037号 .</a><br>&copy; 2013 - <span itemprop="copyrightYear">2017</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">云淡风轻</span></div><div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div><div class="theme-info">主题 - <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a></div></div></footer></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript">$(function(){var e=/(iphone|ipod|ipad|android|iemobile|blackberry|symbianos|windows phone|meego)/.test(navigator.userAgent.toLowerCase());e||$.getScript("/lib/canvas-nest/canvas-nest.min.js")})</script><script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/visibility.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script><script type="text/javascript">var duoshuoQuery={short_name:"ioliu"};!function(){var t=document.createElement("script");t.type="text/javascript",t.async=!0,t.id="duoshuo-script",t.src=("https:"==document.location.protocol?"https:":"http:")+"//static.duoshuo.com/embed.js",t.charset="UTF-8",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(t)}()</script><script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script><script src="/js/src/hook-duoshuo.js?v=5.1.0"></script><script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script><script src="/js/src/hook-duoshuo.js"></script><script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script><script>AV.initialize("R9cQjqaD9AXPKY7AQiU6U6yl","YHUU5n9sbvpRQCdiIU8aRsmH")</script><script>function showTime(e){var t=new AV.Query(e),n=[],o=$(".leancloud_visitors");o.each(function(){n.push($(this).attr("id").trim())}),t.containedIn("url",n),t.find().done(function(e){var t=".leancloud-visitors-count";if(0===e.length)return void o.find(t).text(0);for(var i=0;i<e.length;i++){var r=e[i],s=r.get("url"),l=r.get("time"),c=document.getElementById(s);$(c).find(t).text(l)}for(var i=0;i<n.length;i++){var s=n[i],c=document.getElementById(s),u=$(c).find(t);""==u.text()&&u.text(0)}}).fail(function(e,t){console.log("Error: "+t.code+" "+t.message)})}function addCount(e){var t=$(".leancloud_visitors"),n=t.attr("id").trim(),o=t.attr("data-flag-title").trim(),i=new AV.Query(e);i.equalTo("url",n),i.find({success:function(t){if(t.length>0){var i=t[0];i.fetchWhenSave(!0),i.increment("time"),i.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to save Visitor num, with error message: "+t.message)}})}else{var r=new e,s=new AV.ACL;s.setPublicReadAccess(!0),s.setPublicWriteAccess(!0),r.setACL(s),r.set("title",o),r.set("url",n),r.set("time",1),r.save(null,{success:function(e){var t=$(document.getElementById(n));t.find(".leancloud-visitors-count").text(e.get("time"))},error:function(e,t){console.log("Failed to create")}})}},error:function(e){console.log("Error:"+e.code+" "+e.message)}})}$(function(){var e=AV.Object.extend("Counter");1==$(".leancloud_visitors").length?addCount(e):$(".post-title-link").length>1&&showTime(e)})</script><script>!function(){var t=document.createElement("script"),s=window.location.protocol.split(":")[0];"https"===s?t.src="https://zz.bdstatic.com/linksubmit/push.js":t.src="http://push.zhanzhang.baidu.com/push.js";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}()</script></body></html><!-- rebuild by neat -->